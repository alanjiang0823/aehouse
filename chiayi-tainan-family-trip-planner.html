<!DOCTYPE html>
<html lang="zh-Hant" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>嘉南親子樂遊 | 4天3夜客製化行程 (V3)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Journey -->
    <!-- Application Structure Plan: The SPA is updated to include two new sections: "Souvenirs" and "New Attractions", integrated into the existing task-oriented structure. The top navigation is expanded to link to these new sections. This maintains the user-friendly flow while enriching the content based on the new source report, allowing users to explore more aspects of their trip within the same interface. -->
    <!-- Visualization & Content Choices: 1. Souvenir List -> Goal: Easy discovery of local gifts -> Viz: Card Grid (HTML/Tailwind) -> Interaction: Map icon clicks -> Justification: A visual grid is effective for browsing items. Each card provides key info (name, rating, desc, map link) as requested. 2. New Attractions List -> Goal: Showcase popular spots -> Viz: Card Grid (HTML/Tailwind) -> Interaction: Map icon clicks -> Justification: Similar to souvenirs, a card grid is ideal for presenting attractions with images and essential details, meeting the 4-star+ rating or 5+ blog mentions criteria. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active, .nav-link:hover {
            color: #D97706; /* amber-600 */
            border-bottom-color: #D97706;
        }
        .tab-btn.active {
            background-color: #D97706; /* amber-600 */
            color: #FFFFFF;
        }
        .filter-btn.active {
            background-color: #EA580C; /* orange-600 */
            color: #FFFFFF;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 12px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: #FBBF24; /* amber-400 */
            border: 3px solid #FFFFFF;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
    </style>
</head>
<body class="bg-[#FDFBF8]">

    <header id="header" class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <a href="#" class="text-2xl font-bold text-amber-600">嘉南親子樂遊</a>
                </div>
                <div class="hidden lg:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#overview" class="nav-link px-3 py-2 rounded-md text-sm font-medium">行程總覽</a>
                        <a href="#daily-itinerary" class="nav-link px-3 py-2 rounded-md text-sm font-medium">每日行程</a>
                        <a href="#food-map" class="nav-link px-3 py-2 rounded-md text-sm font-medium">美食地圖</a>
                        <a href="#souvenirs" class="nav-link px-3 py-2 rounded-md text-sm font-medium">熱門伴手禮</a>
                        <a href="#new-attractions" class="nav-link px-3 py-2 rounded-md text-sm font-medium">熱門景點</a>
                        <a href="#costs" class="nav-link px-3 py-2 rounded-md text-sm font-medium">交通費用</a>
                        <a href="#preparation" class="nav-link px-3 py-2 rounded-md text-sm font-medium">行前準備</a>
                    </div>
                </div>
                <div class="lg:hidden">
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-600 hover:text-amber-600 hover:bg-gray-100 focus:outline-none">
                        <span class="sr-only">Open main menu</span>
                        <span class="text-2xl">☰</span>
                    </button>
                </div>
            </div>
        </nav>
        <div id="mobile-menu" class="lg:hidden hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#overview" class="nav-link block px-3 py-2 rounded-md text-base font-medium">行程總覽</a>
                <a href="#daily-itinerary" class="nav-link block px-3 py-2 rounded-md text-base font-medium">每日行程</a>
                <a href="#food-map" class="nav-link block px-3 py-2 rounded-md text-base font-medium">美食地圖</a>
                <a href="#souvenirs" class="nav-link block px-3 py-2 rounded-md text-base font-medium">熱門伴手禮</a>
                <a href="#new-attractions" class="nav-link block px-3 py-2 rounded-md text-base font-medium">熱門景點</a>
                <a href="#costs" class="nav-link block px-3 py-2 rounded-md text-base font-medium">交通費用</a>
                <a href="#preparation" class="nav-link block px-3 py-2 rounded-md text-base font-medium">行前準備</a>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <section id="overview" class="scroll-mt-20 mb-16">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl font-bold text-orange-600 mb-4">嘉義台南4天3夜親子之旅</h1>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto">一趟專為您與5歲孩子設計的悠閒探索之旅，結合自然、文化與美食，創造難忘的夏日家庭回憶。</p>
            </div>
        </section>

        <section id="daily-itinerary" class="scroll-mt-20 mb-16">
            <h2 class="text-3xl font-bold text-center mb-2 text-orange-600">每日行程</h2>
            <p class="text-center text-gray-600 mb-8">以時間軸呈現每日的精彩活動，點擊地圖圖示即可開啟Google Maps導航。</p>
            <div id="tabs-container" class="flex justify-center mb-6 space-x-2 md:space-x-4 bg-amber-100/50 p-2 rounded-full">
                <button data-day="day1" class="tab-btn active px-4 py-2 text-sm md:text-base font-semibold text-amber-800 rounded-full transition-colors duration-300">Day 1 嘉義</button>
                <button data-day="day2" class="tab-btn px-4 py-2 text-sm md:text-base font-semibold text-amber-800 rounded-full transition-colors duration-300">Day 2 台南</button>
                <button data-day="day3" class="tab-btn px-4 py-2 text-sm md:text-base font-semibold text-amber-800 rounded-full transition-colors duration-300">Day 3 台南</button>
                <button data-day="day4" class="tab-btn px-4 py-2 text-sm md:text-base font-semibold text-amber-800 rounded-full transition-colors duration-300">Day 4 返程</button>
            </div>
            <div id="itinerary-content"></div>
        </section>

        <section id="food-map" class="scroll-mt-20 mb-16">
            <h2 class="text-3xl font-bold text-center mb-2 text-orange-600">美食地圖</h2>
            <p class="text-center text-gray-600 mb-8">為您精選嘉義與台南的高評價在地美食，點擊按鈕篩選您想吃的類別！</p>
            <div id="food-filters" class="flex flex-wrap justify-center gap-2 mb-8"></div>
            <div id="food-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </section>

        <section id="souvenirs" class="scroll-mt-20 mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-orange-600">熱門伴手禮精選</h2>
            <div class="mb-12">
                <h3 class="text-2xl font-bold mb-4 text-amber-700 border-l-4 border-amber-500 pl-4">嘉義地區</h3>
                <div id="souvenirs-chiayi" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
            <div>
                <h3 class="text-2xl font-bold mb-4 text-amber-700 border-l-4 border-amber-500 pl-4">台南地區</h3>
                <div id="souvenirs-tainan" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </section>

        <section id="new-attractions" class="scroll-mt-20 mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-orange-600">近期熱門景點</h2>
            <div class="mb-12">
                <h3 class="text-2xl font-bold mb-4 text-amber-700 border-l-4 border-amber-500 pl-4">嘉義地區</h3>
                <div id="attractions-chiayi" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
            <div>
                <h3 class="text-2xl font-bold mb-4 text-amber-700 border-l-4 border-amber-500 pl-4">台南地區</h3>
                <div id="attractions-tainan" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </section>

        <section id="costs" class="scroll-mt-20 mb-16">
            <h2 class="text-3xl font-bold text-center mb-2 text-orange-600">交通費用分析</h2>
            <p class="text-center text-gray-600 mb-8">此圖表為您分析本次旅程的交通費用結構。每日預算提升至3000元後，扣除交通費，您將有更充裕的資金享受美食與活動。</p>
            <div class="bg-white p-4 sm:p-6 rounded-xl shadow-lg">
                <div class="chart-container">
                    <canvas id="costChart"></canvas>
                </div>
            </div>
        </section>

        <section id="preparation" class="scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-8 text-orange-600">行前準備清單</h2>
            <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-amber-700 mb-4">✅ 必備物品</h3>
                    <ul id="checklist-essentials" class="space-y-3 text-gray-600"></ul>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-amber-700 mb-4">✅ 打包技巧</h3>
                    <ul id="checklist-tips" class="space-y-3 text-gray-600"></ul>
                </div>
            </div>
        </section>

    </main>
    
    <footer class="bg-gray-800 text-white mt-16">
        <div class="container mx-auto py-6 px-4 text-center">
            <p>祝您有個美好的親子假期！</p>
            <a href="#header" class="mt-2 inline-block text-amber-400 hover:text-amber-300 transition-colors">返回頂部 ↑</a>
        </div>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const itineraryData = {
        day1: [{ time: '09:00-10:30', activity: '從五堵出發', details: '沿國道1號南下，開啟愉快的旅程。', map: 'https://www.google.com/maps/dir/%E4%BA%94%E5%A0%B5/%E6%B3%B0%E5%AE%89%E6%9C%8D%E5%8B%99%E5%8D%80(%E5%8D%97%E4%B8%8B)/@24.770932,120.730872,9z' },{ time: '10:30-11:30', activity: '泰安服務區 (南下) 休息', details: '在親子主題區讓孩子活動一下筋骨，舒緩長途車的疲憊。', map: 'https://www.google.com/maps/search/?api=1&query=泰安服務區南下' },{ time: '13:00-14:00', activity: '午餐：劉里長火雞肉飯 (4.2★)', details: '品嚐嘉義最經典的在地美味，口味大眾化，適合全家大小。', map: 'https://www.google.com/maps/search/?api=1&query=劉里長火雞肉飯嘉義市東區公明路197號' },{ time: '14:00-16:00', activity: '三隻小豬觀光農場 (4.2★)', details: '與近30種可愛動物互動，還有大草原和遊戲區讓孩子盡情奔跑。', map: 'https://www.google.com/maps/search/?api=1&query=三隻小豬觀光農場嘉義縣民雄鄉民新路369號' },{ time: '16:00-17:30', activity: '入住天成文旅-繪日之丘 (4.3★)', details: '辦理入住，體驗飯店獨特的親子設施，如星空童樂室。', map: 'https://www.google.com/maps/search/?api=1&query=天成文旅-繪日之丘' },{ time: '17:30-19:00', activity: '嘉義市立博物館 (4.4★)', details: '兒童廳充滿互動遊戲，是孩子的專屬展廳，記得要穿襪子喔！', map: 'https://www.google.com/maps/search/?api=1&query=嘉義市立博物館' },{ time: '19:00-20:30', activity: '晚餐：林聰明沙鍋魚頭 (4.1★)', details: '嘉義必吃的排隊美食，濃郁湯頭讓人回味無窮。', map: 'https://www.google.com/maps/search/?api=1&query=林聰明沙鍋魚頭嘉義市東區中正路361號' },],
        day2: [{ time: '09:30-10:30', activity: '前往七股鹽山', details: '從嘉義出發，前往台南的白色童話世界。', map: 'https://www.google.com/maps/dir/天成文旅-繪日之丘/七股鹽山/@23.323896,120.109102,10z' },{ time: '10:30-12:30', activity: '七股鹽山 (4.1★)', details: '攀登獨特的鹽山，搭乘遊園小火車，享受鹽田風光。', map: 'https://www.google.com/maps/search/?api=1&query=七股鹽山' },{ time: '12:30-14:00', activity: '午餐：文章牛肉湯 (4.4★)', details: '品嚐台南必吃的溫體牛肉湯，體驗府城鮮甜滋味。', map: 'https://www.google.com/maps/search/?api=1&query=文章牛肉湯台南市安平區安平路300號' },{ time: '14:00-17:00', activity: '十鼓仁糖文創園區 (4.5★)', details: '欣賞震撼的鼓樂表演，體驗刺激的極限設施與有趣的親子活動。', map: 'https://www.google.com/maps/search/?api=1&query=十鼓仁糖文創園區' },{ time: '17:30-18:30', activity: '入住煙波大飯店台南館 (4.5★)', details: '辦理入住後，可帶孩子到露天泳池玩水消暑。', map: 'https://www.google.com/maps/search/?api=1&query=煙波大飯店台南館' },{ time: '18:30-20:00', activity: '晚餐：咕嚕家庭料理館 (4.3★)', details: '親子友善的家常菜餐廳，份量十足，美味可口。', map: 'https://www.google.com/maps/search/?api=1&query=咕嚕家庭料理館台南市中西區慶中街12號' },],
        day3: [{ time: '10:00-12:30', activity: '奧斯丁夢想樂園 (4.4★)', details: '位於南紡購物中心，是孩子們的室內天堂，記得穿襪子入場。', map: 'https://www.google.com/maps/search/?api=1&query=奧斯丁夢想樂園台南南紡店' },{ time: '12:30-14:00', activity: '午餐：南紡周邊美食', details: '購物中心內有多樣選擇，或可嘗試附近的親子火鍋店。', map: 'https://www.google.com/maps/search/?api=1&query=養鍋Yang+Guo石頭涮涮鍋台南文化店' },{ time: '14:00-17:00', activity: '奇美博物館 (4.7★)', details: '豐富的藝術收藏與寬廣的戶外園區，7歲以下兒童免費入場。', map: 'https://www.google.com/maps/search/?api=1&query=奇美博物館' },{ time: '17:30-19:00', activity: '晚餐：國華街美食探索', details: '可嘗試金得春捲、石精臼蚵仔煎等國華街知名小吃。', map: 'https://www.google.com/maps/search/?api=1&query=台南國華街' },],
        day4: [{ time: '10:00-11:30', activity: '四草綠色隧道 (4.4★)', details: '搭乘竹筏體驗台版亞馬遜河，欣賞紅樹林生態，航程約30分鐘。', map: 'https://www.google.com/maps/search/?api=1&query=四草綠色隧道' },{ time: '11:30-12:30', activity: '午餐：富盛號碗粿 (4.1★)', details: '品嚐台南經典碗粿，為這趟美食之旅劃下完美句點。', map: 'https://www.google.com/maps/search/?api=1&query=富盛號碗粿台南市民族路三段11號' },{ time: '12:30-14:30', activity: '從台南出發北上', details: '帶著滿滿的回憶，準備返回溫暖的家。', map: 'https://www.google.com/maps/dir/台南市/泰安服務區/@23.631024,120.274193,9z' },{ time: '14:30-15:30', activity: '泰安服務區 (北上) 休息', details: '在回程中途稍作休息，補充體力。', map: 'https://www.google.com/maps/search/?api=1&query=泰安服務區北上' },{ time: '17:00', activity: '抵達五堵', details: '平安到家，期待下一次的旅行！', map: 'https://www.google.com/maps/dir/泰安服務區/五堵/@24.770932,120.730872,9z' },]
    };
    const foodData = [{ name: '劉里長火雞肉飯', city: '嘉義', rating: '4.2★', category: 'chiayi-main', map: 'https://www.google.com/maps/search/?api=1&query=劉里長火雞肉飯嘉義市東區公明路197號', desc: '嘉義經典老店，口味大眾化，適合全家品嚐。' },{ name: '林聰明沙鍋魚頭', city: '嘉義', rating: '4.1★', category: 'chiayi-main', map: 'https://www.google.com/maps/search/?api=1&query=林聰明沙鍋魚頭嘉義市東區中正路361號', desc: '必吃排隊美食，湯頭濃郁，魚肉鮮美。' },{ name: '源興御香屋', city: '嘉義', rating: '4.4★', category: 'chiayi-drink', map: 'https://www.google.com/maps/search/?api=1&query=源興御香屋', desc: '超人氣葡萄柚綠茶，夏日消暑聖品。' },{ name: '阿婆烤玉米', city: '嘉義', rating: '4.5★', category: 'chiayi-snack', map: 'https://www.google.com/maps/search/?api=1&query=阿婆烤玉米嘉義市東區民族路312號', desc: '在地人推薦的炭烤糯米玉米，醬料獨特。' },{ name: '文章牛肉湯', city: '台南', rating: '4.4★', category: 'tainan-main', map: 'https://www.google.com/maps/search/?api=1&query=文章牛肉湯台南市安平區安平路300號', desc: '台南牛肉湯指標名店，湯頭鮮美，肉質軟嫩。' },{ name: '富盛號碗粿', city: '台南', rating: '4.1★', category: 'tainan-snack', map: 'https://www.google.com/maps/search/?api=1&query=富盛號碗粿台南市民族路三段11號', desc: '經典古早味，Q彈碗粿搭配豐富內餡。' },{ name: '咕嚕家庭料理館', city: '台南', rating: '4.3★', category: 'tainan-family', map: 'https://www.google.com/maps/search/?api=1&query=咕嚕家庭料理館台南市中西區慶中街12號', desc: '在地人推薦的親子友善餐廳，家常料理份量足。' },{ name: '金得春捲', city: '台南', rating: '4.2★', category: 'tainan-snack', map: 'https://www.google.com/maps/search/?api=1&query=金得春捲台南市中西區民族路三段19號', desc: '國華街人氣名店，用料實在，甜度可調整。' },];
    const foodFilters = [{ key: 'all', name: '全部' },{ key: 'chiayi-main', name: '嘉義主食' },{ key: 'chiayi-snack', name: '嘉義小吃' },{ key: 'chiayi-drink', name: '嘉義飲品' },{ key: 'tainan-main', name: '台南主食' },{ key: 'tainan-snack', name: '台南小吃' },{ key: 'tainan-family', name: '台南餐廳' },];
    const checklistData = { essentials: ["輕便透氣衣物 (多備一套)", "防曬乳、遮陽帽、太陽眼鏡", "輕便雨衣或折疊傘", "個人常備藥品與急救包", "防蚊液或防蚊貼片", "孩童專用安全座椅", "手機、充電器、行動電源", "健保卡、身分證件", "孩童專用安撫玩具或繪本", "襪子 (多個室內景點需要)"], tips: ["使用收納袋分類打包，方便拿取。", "可將孩子每日穿搭分裝成袋。", "隨身包準備少量應急物品。", "重要證件拍照備份存於雲端。", "善用飯店設施，讓孩子充分放電。", "行程保持彈性，依孩子狀況調整。"] };
    
    const souvenirsData = {
        chiayi: [
            { name: '旺萊山鳳梨酥', rating: '4.2★', desc: '使用在地新鮮鳳梨製作，香氣濃郁，是結合觀光工廠的代表性伴手禮。', map: 'https://www.google.com/maps/search/?api=1&query=旺萊山鳳梨文化園區' },
            { name: '老楊方塊酥', rating: '4.2★', desc: '嘉義傳統點心，觀光工廠結合巨型機器人彩繪，好吃又好玩。', map: 'https://www.google.com/maps/search/?api=1&query=老楊方城市觀光工廠' },
            { name: '源興御香屋', rating: '4.4★', desc: '超人氣手搖飲，招牌葡萄柚綠茶是必點美味，常需排隊等候。', map: 'https://www.google.com/maps/search/?api=1&query=源興御香屋' }
        ],
        tainan: [
            { name: '金桃家草莓大福', rating: '4.8★', desc: '台南超搶手的隱藏版美食，以其高品質與限量供應聞名，建議提早預訂。', map: 'https://www.google.com/maps/search/?api=1&query=金桃家草莓大福' },
            { name: '奇美食品幸福工廠', rating: '4.2★', desc: '結合觀光與美食，提供多樣化食品伴手禮，還可體驗DIY活動。', map: 'https://www.google.com/maps/search/?api=1&query=奇美食品幸福工廠' },
            { name: '連得堂餅家', rating: '4.3★', desc: '百年手工煎餅老店，每日限量販售，充滿濃濃古早味，是台南代表性伴手禮。', map: 'https://www.google.com/maps/search/?api=1&query=連得堂餅家' }
        ]
    };

    const attractionsData = {
        chiayi: [
            { name: '新嘉大昆蟲館', rating: '4.4★', desc: '寓教於樂的昆蟲主題館，活體解說導覽和蝴蝶溫室花園深受親子喜愛。', map: 'https://www.google.com/maps/search/?api=1&query=新嘉大昆蟲館' },
            { name: 'KANO園區遊戲場', rating: '4.5★', desc: '免費開放的特色公園，擁有超寬版磨石子溜滑梯和滑草場，是孩子放電天堂。', map: 'https://www.google.com/maps/search/?api=1&query=KANO園區' },
            { name: '蘭潭風景區', rating: '4.3★', desc: '夜晚可欣賞免費的水舞燈光秀，搭配「月影潭心」裝置藝術，是休閒好去處。', map: 'https://www.google.com/maps/search/?api=1&query=蘭潭風景區' }
        ],
        tainan: [
            { name: '奇美博物館', rating: '4.7★', desc: '收藏豐富的綜合性博物館，戶外園區廣闊，AR實境遊戲增添互動樂趣。', map: 'https://www.google.com/maps/search/?api=1&query=奇美博物館' },
            { name: '十鼓仁糖文創園區', rating: '4.5★', desc: '結合鼓樂、極限設施與糖廠文化，提供從幼兒到成人的多元體驗。', map: 'https://www.google.com/maps/search/?api=1&query=十鼓仁糖文創園區' },
            { name: '四草綠色隧道', rating: '4.4★', desc: '搭乘竹筏體驗「台版亞馬遜河」，欣賞獨特的紅樹林生態景觀。', map: 'https://www.google.com/maps/search/?api=1&query=四草綠色隧道' }
        ]
    };

    const itineraryContent = document.getElementById('itinerary-content');
    const foodGrid = document.getElementById('food-grid');
    const foodFiltersContainer = document.getElementById('food-filters');
    const checklistEssentials = document.getElementById('checklist-essentials');
    const checklistTips = document.getElementById('checklist-tips');
    const souvenirsChiayi = document.getElementById('souvenirs-chiayi');
    const souvenirsTainan = document.getElementById('souvenirs-tainan');
    const attractionsChiayi = document.getElementById('attractions-chiayi');
    const attractionsTainan = document.getElementById('attractions-tainan');

    function createTimelineHTML(dayData) {
        return `<div class="relative border-l-2 border-amber-200 pl-8 py-4">${dayData.map(item => `<div class="relative mb-8 timeline-item"><div class="bg-white p-4 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300"><p class="font-bold text-amber-600 mb-1">${item.time}</p><h4 class="text-lg font-semibold text-gray-800">${item.activity}</h4><p class="text-gray-500 text-sm mt-1">${item.details}</p><a href="${item.map}" target="_blank" rel="noopener noreferrer" class="absolute top-4 right-4 text-orange-500 hover:text-orange-700 text-2xl" title="在Google Maps中開啟">🗺️</a></div></div>`).join('')}</div>`;
    }
    
    function renderItinerary(day) { itineraryContent.innerHTML = createTimelineHTML(itineraryData[day]); }

    document.getElementById('tabs-container').addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
            document.querySelector('#tabs-container .active').classList.remove('active');
            e.target.classList.add('active');
            renderItinerary(e.target.dataset.day);
        }
    });

    function renderFoodFilters() {
        foodFiltersContainer.innerHTML = foodFilters.map(filter => `<button data-filter="${filter.key}" class="filter-btn px-4 py-2 text-sm font-semibold border border-orange-500 text-orange-600 rounded-full transition-all duration-300 hover:bg-orange-500 hover:text-white ${filter.key === 'all' ? 'active' : ''}">${filter.name}</button>`).join('');
    }

    function renderFoodGrid(filter = 'all') {
        const filteredData = filter === 'all' ? foodData : foodData.filter(item => item.category.startsWith(filter.split('-')[0]) && (filter.includes('-') ? item.category === filter : true));
        foodGrid.innerHTML = filteredData.map(item => `<div class="bg-white rounded-xl shadow-lg overflow-hidden transform hover:-translate-y-1 transition-transform duration-300"><div class="p-6"><div class="flex justify-between items-start"><div><p class="text-xs font-semibold text-amber-600 uppercase">${item.city} | ${item.rating}</p><h4 class="text-xl font-bold text-gray-800 mt-1">${item.name}</h4></div><a href="${item.map}" target="_blank" rel="noopener noreferrer" class="text-orange-500 hover:text-orange-700 text-3xl ml-4" title="在Google Maps中開啟">📍</a></div><p class="text-gray-600 mt-2 text-sm">${item.desc}</p></div></div>`).join('');
    }

    foodFiltersContainer.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
            foodFiltersContainer.querySelector('.active').classList.remove('active');
            e.target.classList.add('active');
            renderFoodGrid(e.target.dataset.filter);
        }
    });
    
    function renderChecklists() {
        checklistEssentials.innerHTML = checklistData.essentials.map(item => `<li class="flex items-start"><span class="text-amber-500 mr-2 mt-1">🔸</span><span>${item}</span></li>`).join('');
        checklistTips.innerHTML = checklistData.tips.map(item => `<li class="flex items-start"><span class="text-amber-500 mr-2 mt-1">🔸</span><span>${item}</span></li>`).join('');
    }

    function createInfoCard(item) {
        return `<div class="bg-white rounded-xl shadow-lg overflow-hidden transform hover:-translate-y-1 transition-transform duration-300"><div class="p-6"><div class="flex justify-between items-start"><div><p class="text-xs font-semibold text-amber-600 uppercase">${item.rating}</p><h4 class="text-xl font-bold text-gray-800 mt-1">${item.name}</h4></div><a href="${item.map}" target="_blank" rel="noopener noreferrer" class="text-orange-500 hover:text-orange-700 text-3xl ml-4" title="在Google Maps中開啟">📍</a></div><p class="text-gray-600 mt-2 text-sm">${item.desc}</p></div></div>`;
    }

    function renderInfoLists() {
        souvenirsChiayi.innerHTML = souvenirsData.chiayi.map(createInfoCard).join('');
        souvenirsTainan.innerHTML = souvenirsData.tainan.map(createInfoCard).join('');
        attractionsChiayi.innerHTML = attractionsData.chiayi.map(createInfoCard).join('');
        attractionsTainan.innerHTML = attractionsData.tainan.map(createInfoCard).join('');
    }

    new Chart(document.getElementById('costChart').getContext('2d'), {
        type: 'bar',
        data: { labels: ['去程 (五堵→嘉義)', '嘉義→台南', '台南當地 (每日)', '回程 (台南→五堵)'], datasets: [{ label: '油資 (NT$)', data: [577, 162, 69, 738], backgroundColor: 'rgba(234, 179, 8, 0.7)', borderColor: 'rgba(234, 179, 8, 1)', borderWidth: 1 }, { label: '過路費 (NT$)', data: [250, 70, 0, 320], backgroundColor: 'rgba(249, 115, 22, 0.7)', borderColor: 'rgba(249, 115, 22, 1)', borderWidth: 1 }, { label: '停車費 (NT$)', data: [0, 0, 150, 0], backgroundColor: 'rgba(251, 191, 36, 0.7)', borderColor: 'rgba(251, 191, 36, 1)', borderWidth: 1 }] },
        options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: '各路段交通費用預估', font: { size: 16, family: "'Noto Sans TC', sans-serif" }, color: '#4A4A4A' }, tooltip: { callbacks: { label: function(context) { let label = context.dataset.label || ''; if (label) { label += ': '; } if (context.parsed.y !== null) { label += new Intl.NumberFormat('zh-TW', { style: 'currency', currency: 'TWD', minimumFractionDigits: 0 }).format(context.parsed.y); } return label; } } } }, scales: { x: { stacked: true, }, y: { stacked: true, beginAtZero: true, title: { display: true, text: '費用 (新台幣)', font: { family: "'Noto Sans TC', sans-serif" } } } } }
    });

    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenuButton.addEventListener('click', () => { mobileMenu.classList.toggle('hidden'); });

    document.querySelectorAll('#mobile-menu .nav-link, header .nav-link').forEach(link => {
        link.addEventListener('click', (e) => {
            if (e.currentTarget.closest('#mobile-menu')) { mobileMenu.classList.add('hidden'); }
            if(link.getAttribute('href').startsWith('#')) {
                e.preventDefault();
                const targetElement = document.querySelector(link.getAttribute('href'));
                if (targetElement) { targetElement.scrollIntoView({ behavior: 'smooth' }); }
            }
        });
    });
    
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('section');
    window.addEventListener('scroll', () => {
        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            if (pageYOffset >= sectionTop - 80) { current = section.getAttribute('id'); }
        });
        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href').substring(1) === current) { link.classList.add('active'); }
        });
    });

    renderItinerary('day1');
    renderFoodFilters();
    renderFoodGrid('all');
    renderChecklists();
    renderInfoLists();
});
</script>

</body>
</html>
